import{S as fe,i as ue,s as de,k as a,a as S,q as j,l as i,m as u,h as n,c as L,r as J,J as Ee,n as p,p as K,b as z,G as r,L as G,H as te,N as he,O as pe,K as Z,u as ae,M as Le,e as Ne,d as ie,f as Me,g as ce,o as Be,P as Ce,v as je,y as _e,z as ve,A as ge,B as be}from"../chunks/index.d6ec018a.js";import{a as Je}from"../chunks/axios.4a70c6fc.js";const Ue=!0,gt=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ue},Symbol.toStringTag,{value:"Module"}));function Fe(c){let e,t,s,l,o,f,d,g,b,m,_,h,I,A,w,O,y,v,k,E,D,V,C,B,T,N,U,Q,Y,X,P,H,q;return{c(){e=a("div"),t=a("iframe"),l=S(),o=a("p"),f=j(`Peace Messenger serves as your guiding light, assisting
    you with AI in expressing your heartfelt emotions and
    needs to those who are dear to you. 
    `),d=a("br"),g=S(),b=a("center"),m=a("img"),h=S(),I=a("br"),A=j(`    

    This `),w=a("a"),O=j("Open Source "),y=j("project is an attempt to see if AI can make conversations better and help people understand and respect each other more."),v=S(),k=a("br"),E=S(),D=a("div"),V=a("button"),C=a("span"),B=j("Create Room"),T=S(),N=a("button"),U=j("Join Room"),Q=S(),Y=a("div"),X=a("small"),P=j(`Though messages are transmitted with WebRTC peer-to-peer communication, it's also processed with OpenAI. Hence,
        it's not recommended to share any sensitive information.`),this.h()},l(W){e=i(W,"DIV",{});var R=u(e);t=i(R,"IFRAME",{src:!0,frameborder:!0,scrolling:!0,width:!0,height:!0,title:!0}),u(t).forEach(n),l=L(R),o=i(R,"P",{style:!0});var M=u(o);f=J(M,`Peace Messenger serves as your guiding light, assisting
    you with AI in expressing your heartfelt emotions and
    needs to those who are dear to you. 
    `),d=i(M,"BR",{}),g=L(M),b=i(M,"CENTER",{});var F=u(b);m=i(F,"IMG",{src:!0,style:!0}),F.forEach(n),h=L(M),I=i(M,"BR",{}),A=J(M,`    

    This `),w=i(M,"A",{href:!0});var x=u(w);O=J(x,"Open Source "),x.forEach(n),y=J(M,"project is an attempt to see if AI can make conversations better and help people understand and respect each other more."),M.forEach(n),v=L(R),k=i(R,"BR",{}),E=L(R),D=i(R,"DIV",{class:!0});var ee=u(D);V=i(ee,"BUTTON",{class:!0});var $=u(V);C=i($,"SPAN",{});var le=u(C);B=J(le,"Create Room"),le.forEach(n),$.forEach(n),T=L(ee),N=i(ee,"BUTTON",{class:!0});var oe=u(N);U=J(oe,"Join Room"),oe.forEach(n),ee.forEach(n),Q=L(R),Y=i(R,"DIV",{class:!0,style:!0});var se=u(Y);X=i(se,"SMALL",{});var ne=u(X);P=J(ne,`Though messages are transmitted with WebRTC peer-to-peer communication, it's also processed with OpenAI. Hence,
        it's not recommended to share any sensitive information.`),ne.forEach(n),se.forEach(n),R.forEach(n),this.h()},h(){Ee(t.src,s="https://ghbtns.com/github-btn.html?user=jamesfebin&repo=PeaceMessenger&type=star&count=false&size=large")||p(t,"src",s),p(t,"frameborder","0"),p(t,"scrolling","0"),p(t,"width","170"),p(t,"height","30"),p(t,"title","GitHub"),Ee(m.src,_="/peace_messenger/hero.png")||p(m,"src",_),K(m,"height","250px",1),p(w,"href","https://github.com/jamesfebin/PeaceMessenger"),K(o,"text-align","justify",1),K(o,"margin-top","4%"),p(V,"class","button is-info"),p(N,"class","button is-primary"),p(D,"class","buttons"),p(Y,"class","notification is-info is-light"),K(Y,"text-align","justify",1)},m(W,R){z(W,e,R),r(e,t),r(e,l),r(e,o),r(o,f),r(o,d),r(o,g),r(o,b),r(b,m),r(o,h),r(o,I),r(o,A),r(o,w),r(w,O),r(o,y),r(e,v),r(e,k),r(e,E),r(e,D),r(D,V),r(V,C),r(C,B),r(D,T),r(D,N),r(N,U),r(e,Q),r(e,Y),r(Y,X),r(X,P),H||(q=[G(V,"click",c[1]),G(N,"click",c[2])],H=!0)},p:te,i:te,o:te,d(W){W&&n(e),H=!1,he(q)}}}function He(c){const e=pe();return[e,()=>e("message",{type:"navigate",page:"createroom"}),()=>e("message",{type:"navigate",page:"joinroom"})]}class ze extends fe{constructor(e){super(),ue(this,e,He,Fe,de,{})}}function Oe(c){let e,t;return{c(){e=a("div"),t=j(c[2]),this.h()},l(s){e=i(s,"DIV",{class:!0});var l=u(e);t=J(l,c[2]),l.forEach(n),this.h()},h(){p(e,"class","notification is-danger is-light")},m(s,l){z(s,e,l),r(e,t)},p(s,l){l&4&&ae(t,s[2])},d(s){s&&n(e)}}}function Ke(c){let e,t,s,l,o,f,d,g,b,m,_,h,I,A,w,O,y,v,k,E,D,V,C,B,T,N,U,Q,Y,X,P=c[2]&&Oe(c);return{c(){e=a("div"),t=a("center"),s=a("span"),l=j("Create Room"),o=S(),f=a("form"),d=a("div"),g=a("label"),b=j("First Name"),m=S(),_=a("div"),h=a("input"),I=S(),A=a("div"),w=a("label"),O=j("OpenAI Key"),y=S(),v=a("div"),k=a("input"),E=S(),D=a("p"),V=j("This app doesn't save your key. However, it trasmits to the your friend's system, so that messages are processed using AI. Here's a link on how to generate the OpenAI key."),C=S(),P&&P.c(),B=S(),T=a("div"),N=a("div"),U=a("button"),Q=j("Create Room"),this.h()},l(H){e=i(H,"DIV",{class:!0});var q=u(e);t=i(q,"CENTER",{});var W=u(t);s=i(W,"SPAN",{class:!0,style:!0});var R=u(s);l=J(R,"Create Room"),R.forEach(n),W.forEach(n),o=L(q),f=i(q,"FORM",{});var M=u(f);d=i(M,"DIV",{class:!0});var F=u(d);g=i(F,"LABEL",{class:!0});var x=u(g);b=J(x,"First Name"),x.forEach(n),m=L(F),_=i(F,"DIV",{class:!0});var ee=u(_);h=i(ee,"INPUT",{class:!0,type:!0,placeholder:!0}),ee.forEach(n),F.forEach(n),I=L(M),A=i(M,"DIV",{class:!0});var $=u(A);w=i($,"LABEL",{class:!0});var le=u(w);O=J(le,"OpenAI Key"),le.forEach(n),y=L($),v=i($,"DIV",{class:!0});var oe=u(v);k=i(oe,"INPUT",{class:!0,type:!0,placeholder:!0}),oe.forEach(n),E=L($),D=i($,"P",{class:!0});var se=u(D);V=J(se,"This app doesn't save your key. However, it trasmits to the your friend's system, so that messages are processed using AI. Here's a link on how to generate the OpenAI key."),se.forEach(n),$.forEach(n),C=L(M),P&&P.l(M),B=L(M),T=i(M,"DIV",{class:!0});var ne=u(T);N=i(ne,"DIV",{class:!0});var me=u(N);U=i(me,"BUTTON",{class:!0});var re=u(U);Q=J(re,"Create Room"),re.forEach(n),me.forEach(n),ne.forEach(n),M.forEach(n),q.forEach(n),this.h()},h(){p(s,"class","is-size-4"),K(s,"margin-top","5%"),p(g,"class","label"),p(h,"class","input"),p(h,"type","text"),p(h,"placeholder","John"),p(_,"class","control"),p(d,"class","field"),p(w,"class","label"),p(k,"class","input"),p(k,"type","password"),p(k,"placeholder","Enter your OpenAI key"),p(v,"class","control"),p(D,"class","help"),p(A,"class","field"),p(U,"class","button is-info"),p(N,"class","control"),p(T,"class","field"),p(e,"class","is-pulled-left")},m(H,q){z(H,e,q),r(e,t),r(t,s),r(s,l),r(e,o),r(e,f),r(f,d),r(d,g),r(g,b),r(d,m),r(d,_),r(_,h),Z(h,c[0]),r(f,I),r(f,A),r(A,w),r(w,O),r(A,y),r(A,v),r(v,k),Z(k,c[1]),r(A,E),r(A,D),r(D,V),r(f,C),P&&P.m(f,null),r(f,B),r(f,T),r(T,N),r(N,U),r(U,Q),Y||(X=[G(h,"input",c[4]),G(k,"input",c[5]),G(U,"click",c[6])],Y=!0)},p(H,[q]){q&1&&h.value!==H[0]&&Z(h,H[0]),q&2&&k.value!==H[1]&&Z(k,H[1]),H[2]?P?P.p(H,q):(P=Oe(H),P.c(),P.m(f,B)):P&&(P.d(1),P=null)},i:te,o:te,d(H){H&&n(e),P&&P.d(),Y=!1,he(X)}}}function qe(c,e,t){const s=pe();let l,o,f;function d(){if(!l||!o||l.length==0||o.length==0){t(2,f="Please enter your First Name and OpenAI Key");return}s("message",{type:"createroom",name:l,openai_key:o})}function g(){l=this.value,t(0,l)}function b(){o=this.value,t(1,o)}return[l,o,f,d,g,b,()=>d()]}class We extends fe{constructor(e){super(),ue(this,e,qe,Ke,de,{})}}function Xe(c){let e,t,s,l,o,f,d,g,b,m,_,h,I,A,w,O,y,v,k,E,D,V,C,B,T;return{c(){e=a("form"),t=a("div"),s=a("div"),l=a("small"),o=j(`Please forward the below code to your friend, inviting them to
                enter the room.`),f=S(),d=a("div"),g=a("textarea"),b=S(),m=a("br"),_=S(),h=a("div"),I=a("label"),A=a("small"),w=j(`After your friend enters your code, another is produced for
                them. You need to input that here to connect with them.`),O=S(),y=a("div"),v=a("textarea"),k=S(),E=a("div"),D=a("div"),V=a("button"),C=j("Start Chatting"),this.h()},l(N){e=i(N,"FORM",{style:!0});var U=u(e);t=i(U,"DIV",{class:!0});var Q=u(t);s=i(Q,"DIV",{class:!0,style:!0});var Y=u(s);l=i(Y,"SMALL",{style:!0});var X=u(l);o=J(X,`Please forward the below code to your friend, inviting them to
                enter the room.`),X.forEach(n),Y.forEach(n),f=L(Q),d=i(Q,"DIV",{class:!0});var P=u(d);g=i(P,"TEXTAREA",{class:!0}),u(g).forEach(n),P.forEach(n),Q.forEach(n),b=L(U),m=i(U,"BR",{}),_=L(U),h=i(U,"DIV",{class:!0});var H=u(h);I=i(H,"LABEL",{class:!0,style:!0});var q=u(I);A=i(q,"SMALL",{});var W=u(A);w=J(W,`After your friend enters your code, another is produced for
                them. You need to input that here to connect with them.`),W.forEach(n),q.forEach(n),O=L(H),y=i(H,"DIV",{class:!0});var R=u(y);v=i(R,"TEXTAREA",{class:!0,placeholder:!0}),u(v).forEach(n),R.forEach(n),H.forEach(n),k=L(U),E=i(U,"DIV",{class:!0});var M=u(E);D=i(M,"DIV",{class:!0});var F=u(D);V=i(F,"BUTTON",{class:!0});var x=u(V);C=J(x,"Start Chatting"),x.forEach(n),F.forEach(n),M.forEach(n),U.forEach(n),this.h()},h(){K(l,"font-weight","500",1),p(s,"class","notification is-info is-light"),K(s,"font-weight","500",1),K(s,"margin-bottom","2%"),p(g,"class","textarea"),g.readOnly=!0,p(d,"class","control"),p(t,"class","field"),p(I,"class","label"),K(I,"font-weight","500",1),p(v,"class","textarea"),p(v,"placeholder","Enter your friend's code here"),p(y,"class","control"),p(h,"class","field"),p(V,"class","button is-info"),p(D,"class","control"),p(E,"class","field"),K(e,"margin-top","4%")},m(N,U){z(N,e,U),r(e,t),r(t,s),r(s,l),r(l,o),r(t,f),r(t,d),r(d,g),Z(g,c[0]),r(e,b),r(e,m),r(e,_),r(e,h),r(h,I),r(I,A),r(A,w),r(h,O),r(h,y),r(y,v),Z(v,c[1]),r(e,k),r(e,E),r(E,D),r(D,V),r(V,C),B||(T=[G(g,"click",Ge),G(g,"input",c[3]),G(v,"input",c[4]),G(V,"click",c[5])],B=!0)},p(N,[U]){U&1&&Z(g,N[0]),U&2&&Z(v,N[1])},i:te,o:te,d(N){N&&n(e),B=!1,he(T)}}}function Ge(c){c.target.select()}function Ye(c,e,t){const s=pe();let{offer:l}=e,{recievedOffer:o}=e;function f(){l=this.value,t(0,l)}function d(){o=this.value,t(1,o)}const g=()=>s("message",{type:"join",remoteDescription:o});return c.$$set=b=>{"offer"in b&&t(0,l=b.offer),"recievedOffer"in b&&t(1,o=b.recievedOffer)},[l,o,s,f,d,g]}class Qe extends fe{constructor(e){super(),ue(this,e,Ye,Xe,de,{offer:0,recievedOffer:1})}}function Ze(c){let e,t,s,l,o,f,d,g,b,m,_,h,I,A,w,O,y,v,k,E,D,V,C,B=c[1]&&Re(c);return{c(){e=a("div"),t=a("label"),s=a("small"),l=j(`Please paste the code shared by your friend who created the
                    room.`),o=S(),f=a("div"),d=a("textarea"),g=S(),B&&B.c(),b=S(),m=a("div"),_=a("label"),h=a("small"),I=j("Name"),A=S(),w=a("div"),O=a("textarea"),y=S(),v=a("div"),k=a("div"),E=a("button"),D=j("Join Room"),this.h()},l(T){e=i(T,"DIV",{class:!0});var N=u(e);t=i(N,"LABEL",{class:!0,style:!0});var U=u(t);s=i(U,"SMALL",{});var Q=u(s);l=J(Q,`Please paste the code shared by your friend who created the
                    room.`),Q.forEach(n),U.forEach(n),o=L(N),f=i(N,"DIV",{class:!0});var Y=u(f);d=i(Y,"TEXTAREA",{class:!0}),u(d).forEach(n),Y.forEach(n),N.forEach(n),g=L(T),B&&B.l(T),b=L(T),m=i(T,"DIV",{class:!0});var X=u(m);_=i(X,"LABEL",{class:!0,style:!0});var P=u(_);h=i(P,"SMALL",{});var H=u(h);I=J(H,"Name"),H.forEach(n),P.forEach(n),A=L(X),w=i(X,"DIV",{class:!0});var q=u(w);O=i(q,"TEXTAREA",{class:!0,placeholder:!0}),u(O).forEach(n),q.forEach(n),X.forEach(n),y=L(T),v=i(T,"DIV",{class:!0});var W=u(v);k=i(W,"DIV",{class:!0});var R=u(k);E=i(R,"BUTTON",{class:!0});var M=u(E);D=J(M,"Join Room"),M.forEach(n),R.forEach(n),W.forEach(n),this.h()},h(){p(t,"class","label"),K(t,"font-weight","500",1),p(d,"class","textarea"),p(f,"class","control"),p(e,"class","field"),p(_,"class","label"),K(_,"font-weight","500",1),p(O,"class","input"),p(O,"placeholder","John"),p(w,"class","control"),p(m,"class","field"),p(E,"class","button is-info"),p(k,"class","control"),p(v,"class","field")},m(T,N){z(T,e,N),r(e,t),r(t,s),r(s,l),r(e,o),r(e,f),r(f,d),Z(d,c[3]),z(T,g,N),B&&B.m(T,N),z(T,b,N),z(T,m,N),r(m,_),r(_,h),r(h,I),r(m,A),r(m,w),r(w,O),Z(O,c[2]),z(T,y,N),z(T,v,N),r(v,k),r(k,E),r(E,D),V||(C=[G(d,"click",Se),G(d,"input",c[6]),G(O,"input",c[7]),G(E,"click",c[8])],V=!0)},p(T,N){N&8&&Z(d,T[3]),T[1]?B?B.p(T,N):(B=Re(T),B.c(),B.m(b.parentNode,b)):B&&(B.d(1),B=null),N&4&&Z(O,T[2])},d(T){T&&n(e),T&&n(g),B&&B.d(T),T&&n(b),T&&n(m),T&&n(y),T&&n(v),V=!1,he(C)}}}function xe(c){let e,t,s,l,o,f,d,g,b,m,_,h,I,A;return{c(){e=a("div"),t=a("div"),s=a("small"),l=j(`Please forward the below code to your friend, once they
                    enter this, you will be automatically connected.`),o=S(),f=a("div"),d=a("textarea"),g=S(),b=a("button"),m=a("span"),_=a("i"),h=j(" Waiting"),this.h()},l(w){e=i(w,"DIV",{class:!0});var O=u(e);t=i(O,"DIV",{class:!0,style:!0});var y=u(t);s=i(y,"SMALL",{style:!0});var v=u(s);l=J(v,`Please forward the below code to your friend, once they
                    enter this, you will be automatically connected.`),v.forEach(n),y.forEach(n),o=L(O),f=i(O,"DIV",{class:!0});var k=u(f);d=i(k,"TEXTAREA",{class:!0}),u(d).forEach(n),k.forEach(n),O.forEach(n),g=L(w),b=i(w,"BUTTON",{class:!0});var E=u(b);m=i(E,"SPAN",{});var D=u(m);_=i(D,"I",{class:!0}),u(_).forEach(n),h=J(D," Waiting"),D.forEach(n),E.forEach(n),this.h()},h(){K(s,"font-weight","550",1),p(t,"class","notification is-info is-light"),K(t,"font-weight","550",1),K(t,"margin-bottom","2%"),p(d,"class","textarea"),d.readOnly=!0,p(f,"class","control"),p(e,"class","field"),p(_,"class","fas fa-spinner fa-spin"),p(b,"class","button is-info")},m(w,O){z(w,e,O),r(e,t),r(t,s),r(s,l),r(e,o),r(e,f),r(f,d),Z(d,c[0]),z(w,g,O),z(w,b,O),r(b,m),r(m,_),r(m,h),I||(A=[G(d,"click",Se),G(d,"input",c[5])],I=!0)},p(w,O){O&1&&Z(d,w[0])},d(w){w&&n(e),w&&n(g),w&&n(b),I=!1,he(A)}}}function Re(c){let e,t,s;return{c(){e=a("div"),t=a("small"),s=j(c[1]),this.h()},l(l){e=i(l,"DIV",{class:!0});var o=u(e);t=i(o,"SMALL",{});var f=u(t);s=J(f,c[1]),f.forEach(n),o.forEach(n),this.h()},h(){p(e,"class","notification is-danger is-light")},m(l,o){z(l,e,o),r(e,t),r(t,s)},p(l,o){o&2&&ae(s,l[1])},d(l){l&&n(e)}}}function $e(c){let e,t,s,l,o,f;function d(m,_){return m[0]?xe:Ze}let g=d(c),b=g(c);return{c(){e=a("div"),t=a("center"),s=a("span"),l=j("Join Room"),o=S(),f=a("form"),b.c(),this.h()},l(m){e=i(m,"DIV",{});var _=u(e);t=i(_,"CENTER",{});var h=u(t);s=i(h,"SPAN",{class:!0,style:!0});var I=u(s);l=J(I,"Join Room"),I.forEach(n),h.forEach(n),o=L(_),f=i(_,"FORM",{style:!0});var A=u(f);b.l(A),A.forEach(n),_.forEach(n),this.h()},h(){p(s,"class","is-size-4"),K(s,"margin-top","5%"),K(f,"margin-top","4%")},m(m,_){z(m,e,_),r(e,t),r(t,s),r(s,l),r(e,o),r(e,f),b.m(f,null)},p(m,[_]){g===(g=d(m))&&b?b.p(m,_):(b.d(1),b=g(m),b&&(b.c(),b.m(f,null)))},i:te,o:te,d(m){m&&n(e),b.d()}}}function Se(c){c.target.select()}function et(c,e,t){const s=pe();let{offer:l}=e,{exchangeError:o}=e,f,d;function g(){l=this.value,t(0,l)}function b(){d=this.value,t(3,d)}function m(){f=this.value,t(2,f)}const _=()=>s("message",{type:"join",remoteDescription:d,name:f});return c.$$set=h=>{"offer"in h&&t(0,l=h.offer),"exchangeError"in h&&t(1,o=h.exchangeError)},[l,o,f,d,s,g,b,m,_]}class tt extends fe{constructor(e){super(),ue(this,e,et,$e,de,{offer:0,exchangeError:1})}}function Ve(c,e,t){const s=c.slice();return s[3]=e[t],s}function st(c){let e,t=c[3].sender+"",s,l,o,f,d,g=c[3].message+"",b,m,_;return{c(){e=a("b"),s=j(t),l=S(),o=a("br"),f=S(),d=a("p"),b=j(g),m=S(),_=a("br")},l(h){e=i(h,"B",{});var I=u(e);s=J(I,t),I.forEach(n),l=L(h),o=i(h,"BR",{}),f=L(h),d=i(h,"P",{});var A=u(d);b=J(A,g),A.forEach(n),m=L(h),_=i(h,"BR",{})},m(h,I){z(h,e,I),r(e,s),z(h,l,I),z(h,o,I),z(h,f,I),z(h,d,I),r(d,b),z(h,m,I),z(h,_,I)},p(h,I){I&2&&t!==(t=h[3].sender+"")&&ae(s,t),I&2&&g!==(g=h[3].message+"")&&ae(b,g)},d(h){h&&n(e),h&&n(l),h&&n(o),h&&n(f),h&&n(d),h&&n(m),h&&n(_)}}}function rt(c){let e,t,s=c[3].sender+"",l,o,f,d,g,b,m,_,h=c[3].message+"",I,A,w,O;return{c(){e=a("div"),t=a("b"),l=j(s),o=S(),f=a("small"),d=j("(Only visible to you)"),g=S(),b=a("br"),m=S(),_=a("p"),I=j(h),A=S(),w=a("br"),O=S(),this.h()},l(y){e=i(y,"DIV",{class:!0,style:!0});var v=u(e);t=i(v,"B",{});var k=u(t);l=J(k,s),k.forEach(n),o=L(v),f=i(v,"SMALL",{});var E=u(f);d=J(E,"(Only visible to you)"),E.forEach(n),g=L(v),b=i(v,"BR",{}),m=L(v),_=i(v,"P",{});var D=u(_);I=J(D,h),D.forEach(n),A=L(v),w=i(v,"BR",{}),O=L(v),v.forEach(n),this.h()},h(){p(e,"class","notification is-primary is-light"),K(e,"font-weight","500",1),K(e,"margin-bottom","2%")},m(y,v){z(y,e,v),r(e,t),r(t,l),r(e,o),r(e,f),r(f,d),r(e,g),r(e,b),r(e,m),r(e,_),r(_,I),r(e,A),r(e,w),r(e,O)},p(y,v){v&2&&s!==(s=y[3].sender+"")&&ae(l,s),v&2&&h!==(h=y[3].message+"")&&ae(I,h)},d(y){y&&n(e)}}}function Pe(c){let e;function t(o,f){return o[3].sender=="Peace Messenger"?rt:st}let s=t(c),l=s(c);return{c(){l.c(),e=Ne()},l(o){l.l(o),e=Ne()},m(o,f){l.m(o,f),z(o,e,f)},p(o,f){s===(s=t(o))&&l?l.p(o,f):(l.d(1),l=s(o),l&&(l.c(),l.m(e.parentNode,e)))},d(o){l.d(o),o&&n(e)}}}function lt(c){let e;return{c(){e=j("Seek Peace")},l(t){e=J(t,"Seek Peace")},m(t,s){z(t,e,s)},d(t){t&&n(e)}}}function ot(c){let e,t,s;return{c(){e=a("span"),t=a("i"),s=j(" Please Wait"),this.h()},l(l){e=i(l,"SPAN",{});var o=u(e);t=i(o,"I",{class:!0}),u(t).forEach(n),s=J(o," Please Wait"),o.forEach(n),this.h()},h(){p(t,"class","fas fa-spinner fa-spin")},m(l,o){z(l,e,o),r(e,t),r(e,s)},d(l){l&&n(e)}}}function nt(c){let e,t,s,l,o,f,d,g,b,m,_,h,I,A,w,O,y,v,k,E,D,V,C,B,T,N,U,Q,Y,X=c[1],P=[];for(let R=0;R<X.length;R+=1)P[R]=Pe(Ve(c,X,R));function H(R,M){return R[2]?ot:lt}let q=H(c),W=q(c);return{c(){e=a("div"),t=a("center"),s=a("span"),l=a("b"),o=j("Connected with "),f=j(c[0]),d=S(),g=a("div"),b=a("small");for(let R=0;R<P.length;R+=1)P[R].c();m=S(),_=a("div"),h=a("form"),I=a("div"),A=a("div"),w=a("textarea"),O=S(),y=a("div"),v=a("div"),k=a("button"),E=j("Send"),D=S(),V=a("div"),C=a("button"),W.c(),B=S(),T=a("div"),N=a("button"),U=j("Export"),this.h()},l(R){e=i(R,"DIV",{});var M=u(e);t=i(M,"CENTER",{});var F=u(t);s=i(F,"SPAN",{class:!0});var x=u(s);l=i(x,"B",{});var ee=u(l);o=J(ee,"Connected with "),f=J(ee,c[0]),ee.forEach(n),x.forEach(n),F.forEach(n),d=L(M),g=i(M,"DIV",{id:!0,style:!0});var $=u(g);b=i($,"SMALL",{});var le=u(b);for(let ye=0;ye<P.length;ye+=1)P[ye].l(le);le.forEach(n),$.forEach(n),m=L(M),_=i(M,"DIV",{class:!0});var oe=u(_);h=i(oe,"FORM",{});var se=u(h);I=i(se,"DIV",{class:!0});var ne=u(I);A=i(ne,"DIV",{class:!0});var me=u(A);w=i(me,"TEXTAREA",{class:!0,placeholder:!0}),u(w).forEach(n),me.forEach(n),ne.forEach(n),O=L(se),y=i(se,"DIV",{class:!0});var re=u(y);v=i(re,"DIV",{class:!0});var ke=u(v);k=i(ke,"BUTTON",{type:!0,class:!0});var Ie=u(k);E=J(Ie,"Send"),Ie.forEach(n),ke.forEach(n),D=L(re),V=i(re,"DIV",{class:!0});var we=u(V);C=i(we,"BUTTON",{type:!0,class:!0});var Ae=u(C);W.l(Ae),Ae.forEach(n),we.forEach(n),B=L(re),T=i(re,"DIV",{class:!0});var De=u(T);N=i(De,"BUTTON",{type:!0,class:!0});var Te=u(N);U=J(Te,"Export"),Te.forEach(n),De.forEach(n),re.forEach(n),se.forEach(n),oe.forEach(n),M.forEach(n),this.h()},h(){p(s,"class","tag is-primary is-rounded"),p(g,"id","messages"),K(g,"height","50vh"),K(g,"overflow","scroll"),K(g,"margin-top","2%"),K(g,"display","flex"),K(g,"flex-direction","column-reverse"),p(w,"class","textarea"),p(w,"placeholder","Type your message here"),p(A,"class","control"),p(I,"class","field"),p(k,"type","button"),p(k,"class","button is-info"),p(v,"class","control"),p(C,"type","button"),p(C,"class","button is-primary"),p(V,"class","control"),p(N,"type","button"),p(N,"class","button"),p(T,"class","control"),p(y,"class","field is-grouped"),p(_,"class","footer-fixed")},m(R,M){z(R,e,M),r(e,t),r(t,s),r(s,l),r(l,o),r(l,f),r(e,d),r(e,g),r(g,b);for(let F=0;F<P.length;F+=1)P[F]&&P[F].m(b,null);r(e,m),r(e,_),r(_,h),r(h,I),r(I,A),r(A,w),Z(w,c[3]),r(h,O),r(h,y),r(y,v),r(v,k),r(k,E),r(y,D),r(y,V),r(V,C),W.m(C,null),r(y,B),r(y,T),r(T,N),r(N,U),Q||(Y=[G(w,"input",c[10]),G(w,"keyup",c[6]),G(k,"click",c[11]),G(C,"click",c[12]),G(N,"click",c[13])],Q=!0)},p(R,[M]){if(M&1&&ae(f,R[0]),M&2){X=R[1];let F;for(F=0;F<X.length;F+=1){const x=Ve(R,X,F);P[F]?P[F].p(x,M):(P[F]=Pe(x),P[F].c(),P[F].m(b,null))}for(;F<P.length;F+=1)P[F].d(1);P.length=X.length}M&8&&Z(w,R[3]),q!==(q=H(R))&&(W.d(1),W=q(R),W&&(W.c(),W.m(C,null)))},i:te,o:te,d(R){R&&n(e),Le(P,R),W.d(),Q=!1,he(Y)}}}function at(c,e,t){let{name:s}=e,{peerName:l}=e,{messages:o}=e,{openai_key:f}=e,d;const g=pe();let b=!1;function m(){var k=o.map(D=>D.sender+" : "+D.message+`
`);k=k.join("");var E=document.createElement("a");E.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(k)),E.setAttribute("download","peace_messenger_conversation.txt"),E.style.display="none",document.body.appendChild(E),E.click(),document.body.removeChild(E)}function _(){console.log("sending message");let k={type:"send",sender:s,message:d,timestamp:Math.floor(Date.now()/1e3)};console.log(k),g("message",k),t(3,d="")}function h(k){k.key==="Enter"&&!k.shiftKey&&_()}async function I(k){console.log(f),t(2,b=!0);let E={};try{const D={method:"POST",url:"https://api.openai.com/v1/chat/completions",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},data:{model:"gpt-3.5-turbo",messages:[{role:"user",content:k}]}};E={type:"appendmessage",sender:"Peace Messenger",message:(await Je.request(D)).data.choices[0].message.content,timestamp:Math.floor(Date.now()/1e3)},console.log(E)}catch{E={type:"appendmessage",sender:"Peace Messenger",message:"Unable to connect to OpenAI or Invalid API Key.",timestamp:Math.floor(Date.now()/1e3)}}g("message",E),t(2,b=!1)}async function A(){console.log("Seeking Peace");let E=o.map(C=>C.sender=="Peace Messenger"?"":C.sender+" : "+C.message+`
`).join("");console.log(E);let D=E.split(" ").slice(-900).join(" "),V=`Analyze the conversation provided then use principles from Marshall Rosenberg's 'Nonviolent Communication: A Language of Life'. Guide ${s} towards peaceful conflict resolution. Include example phrases in quotes as necessary. Limit your response to under six lines 

 ==Conversation Start== 
 ${D} 
 ==Conversation End== 

. Now guide ${s} what he needs to do.`;I(V)}function w(){d=this.value,t(3,d)}const O=()=>_(),y=()=>A(),v=()=>m();return c.$$set=k=>{"name"in k&&t(8,s=k.name),"peerName"in k&&t(0,l=k.peerName),"messages"in k&&t(1,o=k.messages),"openai_key"in k&&t(9,f=k.openai_key)},[l,o,b,d,m,_,h,A,s,f,w,O,y,v]}class it extends fe{constructor(e){super(),ue(this,e,at,nt,de,{name:8,peerName:0,messages:1,openai_key:9})}}function ct(c){let e,t;return e=new it({props:{name:c[4],peerName:c[5],messages:c[6],openai_key:c[7]}}),e.$on("message",c[8]),{c(){_e(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,l){ge(e,s,l),t=!0},p(s,l){const o={};l&16&&(o.name=s[4]),l&32&&(o.peerName=s[5]),l&64&&(o.messages=s[6]),l&128&&(o.openai_key=s[7]),e.$set(o)},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){ie(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function ft(c){let e,t;return e=new tt({props:{offer:c[0],exchangeError:c[1],peer:c[3]}}),e.$on("message",c[8]),{c(){_e(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,l){ge(e,s,l),t=!0},p(s,l){const o={};l&1&&(o.offer=s[0]),l&2&&(o.exchangeError=s[1]),l&8&&(o.peer=s[3]),e.$set(o)},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){ie(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function ut(c){let e,t;return e=new Qe({props:{offer:c[0],peer:c[3]}}),e.$on("message",c[8]),{c(){_e(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,l){ge(e,s,l),t=!0},p(s,l){const o={};l&1&&(o.offer=s[0]),l&8&&(o.peer=s[3]),e.$set(o)},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){ie(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function dt(c){let e,t;return e=new We({props:{peer:c[3]}}),e.$on("message",c[8]),{c(){_e(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,l){ge(e,s,l),t=!0},p(s,l){const o={};l&8&&(o.peer=s[3]),e.$set(o)},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){ie(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function ht(c){let e,t;return e=new ze({props:{peer:c[3]}}),e.$on("message",c[8]),{c(){_e(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,l){ge(e,s,l),t=!0},p(s,l){const o={};l&8&&(o.peer=s[3]),e.$set(o)},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){ie(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function mt(c){let e,t,s,l,o,f,d,g,b,m,_,h,I,A,w,O;const y=[ht,dt,ut,ft,ct],v=[];function k(E,D){return E[2]=="home"?0:E[2]=="createroom"?1:E[2]=="exchangeoffers"?2:E[2]=="joinroom"?3:E[2]=="chat"?4:-1}return~(m=k(c))&&(_=v[m]=y[m](c)),{c(){e=a("main"),t=a("div"),s=a("div"),l=S(),o=a("div"),f=a("div"),d=a("img"),b=S(),_&&_.c(),h=S(),I=a("div"),this.h()},l(E){e=i(E,"MAIN",{});var D=u(e);t=i(D,"DIV",{class:!0});var V=u(t);s=i(V,"DIV",{class:!0}),u(s).forEach(n),l=L(V),o=i(V,"DIV",{class:!0});var C=u(o);f=i(C,"DIV",{style:!0});var B=u(f);d=i(B,"IMG",{style:!0,src:!0}),b=L(B),_&&_.l(B),B.forEach(n),C.forEach(n),h=L(V),I=i(V,"DIV",{class:!0}),u(I).forEach(n),V.forEach(n),D.forEach(n),this.h()},h(){p(s,"class","column is-4"),K(d,"cursor","default"),Ee(d.src,g="/peace_messenger/logo_2x.png")||p(d,"src",g),K(f,"margin-top","0%"),p(o,"class","column is-4"),p(I,"class","column is-4"),p(t,"class","columns")},m(E,D){z(E,e,D),r(e,t),r(t,s),r(t,l),r(t,o),r(o,f),r(f,d),r(f,b),~m&&v[m].m(f,null),r(t,h),r(t,I),A=!0,w||(O=G(d,"click",c[9]),w=!0)},p(E,[D]){let V=m;m=k(E),m===V?~m&&v[m].p(E,D):(_&&(je(),ie(v[V],1,1,()=>{v[V]=null}),Me()),~m?(_=v[m],_?_.p(E,D):(_=v[m]=y[m](E),_.c()),ce(_,1),_.m(f,null)):_=null)},i(E){A||(ce(_),A=!0)},o(E){ie(_),A=!1},d(E){E&&n(e),~m&&v[m].d(),w=!1,O()}}}function pt(c,e,t){let s,l,o,f="home",d,g,b,m=[],_,h=!1;function I(y){y.preventDefault(),t(0,s=null),l=null,t(7,_=null),t(4,g=null),t(3,d=null),t(5,b=null),t(6,m=[]),t(2,f="home")}Be(()=>{h=!0,window.addEventListener("popstate",I)}),Ce(()=>{h&&window.removeEventListener("popstate",I)});function A(y){t(3,d=new SimplePeer({initiator:y,trickle:!1})),t(3,d._debug=console.log,d),d.on("signal",v=>{t(0,s=btoa(JSON.stringify(v)))}),d.on("connect",()=>{console.log("Peer connected!"),f!="chat"&&(t(2,f="chat"),d.send(JSON.stringify({user:"system",type:"name",name:g}))),_&&d.send(JSON.stringify({user:"system",type:"openai",openai_key:_}))}),d.on("data",v=>{v=JSON.parse(v.toString()),v.type=="name"?(t(5,b=v.name),d.send(JSON.stringify({user:"system",type:"name",name:g}))):v.type=="message"?(console.log(v),t(6,m=[...m,v])):v.type=="openai"&&(console.log(v),t(7,_=v.openai_key))}),d.on("error",v=>{f!="chat"&&d.signal(l.trim())})}function w(y){if(console.log(y),y.detail.type=="navigate")t(2,f=y.detail.page),f=="createroom"?(window.history.pushState({page:f},null,null),A(!0)):f=="joinroom"&&(window.history.pushState({page:f},null,null),A(!1));else if(y.detail.type=="join"){console.log("Joining"),l=y.detail.remoteDescription,y.detail.name&&t(4,g=y.detail.name);try{console.log(atob(l)),d.signal(JSON.parse(atob(l.trim())))}catch(v){console.log(v),t(1,o="Please paste a valid code.")}}else y.detail.type=="createroom"?(t(4,g=y.detail.name),t(2,f="exchangeoffers"),console.log("creating Room"),console.log(g),t(7,_=y.detail.openai_key)):y.detail.type=="send"?(console.log("sending"),t(6,m=[...m,y.detail]),d.send(JSON.stringify({sender:y.detail.sender,message:y.detail.message,type:"message",timestamp:y.detail.timestamp}))):y.detail.type=="appendmessage"&&t(6,m=[...m,y.detail])}return[s,o,f,d,g,b,m,_,w,()=>t(2,f="home")]}class bt extends fe{constructor(e){super(),ue(this,e,pt,mt,de,{})}}export{bt as component,gt as universal};
